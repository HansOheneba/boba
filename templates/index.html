<!DOCTYPE html>
<html
  lang="en"
  x-data="{ showModal: false, showToppingsModal: false, showShawarmaModal: false, total: 0, orderNumber: '', name: '', location: '', notes: '', phone: '', selectedBoba: '', selectedShawarma: '', selectedShawarmaType: '', selectedBobaType: '' }"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Order Boba & Shawarma</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js"
      defer
    ></script>
  </head>
  <body class="bg-gray-100">
    <div
      class="max-w-md mx-auto bg-white shadow-lg rounded-lg overflow-hidden mt-10"
    >
      <div class="p-4">
        <h1 class="text-xl font-bold text-center">Bubble Bliss</h1>
        <form action="/" method="POST" class="mt-4" id="order-form">
          <div class="mt-4">
  <h2 class="text-lg font-semibold">Boba Tea</h2>
  <div class="overflow-x-auto whitespace-nowrap flex gap-4 mt-4 p-2">
    <div class="grid grid-cols-4 gap-4 flex-shrink-0">
      <!-- Blueberry Boba -->
      <div class="bg-blue-500 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Blueberry Boba' }" 
        @click="selectBobaType('Blueberry Boba')">
        <img src="{{ url_for('static', filename='img/blueberry_boba.png') }}" alt="Blueberry Boba" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Blueberry Boba</p>
      </div>
      
      <!-- Brown Sugar Boba -->
      <div class="bg-yellow-700 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Brown Sugar Boba' }" 
        @click="selectBobaType('Brown Sugar Boba')">
        <img src="{{ url_for('static', filename='img/brown_sugar_boba.png') }}" alt="Brown Sugar Boba" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Brown Sugar Boba</p>
      </div>
      
      <!-- Caramel Milk -->
      <div class="bg-amber-500 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Caramel Milk' }" 
        @click="selectBobaType('Caramel Milk')">
        <img src="{{ url_for('static', filename='img/caramel_milk.png') }}" alt="Caramel Milk" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Caramel Milk</p>
      </div>
      
      <!-- Classic Boba -->
      <div class="bg-gray-700 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Classic Boba' }" 
        @click="selectBobaType('Classic Boba')">
        <img src="{{ url_for('static', filename='img/classic_boba.png') }}" alt="Classic Boba" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Classic Boba</p>
      </div>
      
      <!-- Coconut Milk -->
      <div class="bg-teal-500 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Coconut Milk' }" 
        @click="selectBobaType('Coconut Milk')">
        <img src="{{ url_for('static', filename='img/coconut_milk.png') }}" alt="Coconut Milk" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Coconut Milk</p>
      </div>
      
      <!-- Coffee -->
      <div class="bg-red-950 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Coffee' }" 
        @click="selectBobaType('Coffee')">
        <img src="{{ url_for('static', filename='img/coffee.png') }}" alt="Coffee" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Coffee</p>
      </div>
      
      <!-- Taro Boba -->
      <div class="bg-purple-500 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Taro Boba' }" 
        @click="selectBobaType('Taro Boba')">
        <img src="{{ url_for('static', filename='img/taro_boba.png') }}" alt="Taro Boba" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Taro Boba</p>
      </div>
      
      <!-- Vanilla Boba -->
      <div class="bg-yellow-300 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer border-4 border-transparent w-48" 
        x-bind:class="{ 'border-green-500': selectedBobaType === 'Vanilla Boba' }" 
        @click="selectBobaType('Vanilla Boba')">
        <img src="{{ url_for('static', filename='img/vanilla_boba.png') }}" alt="Vanilla Boba" class="mx-auto rounded-full w-24 h-24" />
        <p class="mt-2 font-bold">Vanilla Boba</p>
      </div>
    </div>
  </div>
</div>
          <div class="mt-4 text-sm">
            <h2 class="text-lg font-semibold">Shawarma</h2>
            <div class="grid grid-cols-2 gap-4 mt-4 text-white">
              <button
                type="button"
                class="p-4 bg-yellow-500 rounded-lg font-semibold"
                onclick="selectShawarmaType('Chicken Shawarma')"
              >
                Chicken Shawarma
              </button>
              <button
                type="button"
                class="p-4 bg-red-700 rounded-lg font-semibold"
                onclick="selectShawarmaType('Beef Shawarma')"
              >
                Beef Shawarma
              </button>
            </div>
          </div>
          <div class="mt-4">
            <h2 class="text-lg font-semibold">Your Order</h2>
            <ul id="cart" class="list-disc pl-4 text-gray-700"></ul>
            <div id="total-container" class="mt-2 text-right font-bold hidden">
              Total: <span id="total">0</span> GHS
            </div>
            <input type="hidden" name="order" id="order-input" />
            <input type="hidden" name="total" id="total-input" />
            <input
              type="text"
              name="name"
              placeholder="Enter your name"
              required
              class="w-full p-2 mt-2 border rounded"
              x-model="name"
            />
            <input
              type="text"
              name="location"
              placeholder="Enter your location"
              required
              class="w-full p-2 mt-2 border rounded"
              x-model="location"
            />
            <textarea
              name="notes"
              placeholder="Any special requests?"
              class="w-full p-2 mt-2 border rounded"
              x-model="notes"
            ></textarea>
            <input
              type="text"
              name="phone"
              placeholder="Enter your phone number"
              required
              class="w-full p-2 mt-2 border rounded"
              x-model="phone"
            />
            <button
              type="button"
              class="mt-4 w-full bg-blue-500 text-white p-2 rounded"
              @click="validateForm()"
            >
              Place Order
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Toppings Modal -->
  <div
  x-show="showToppingsModal"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 p-4"
  x-transition:enter="transition ease-out duration-300"
  x-transition:enter-start="opacity-0"
  x-transition:enter-end="opacity-100"
  x-transition:leave="transition ease-in duration-300"
  x-transition:leave-start="opacity-100"
  x-transition:leave-end="opacity-0"
>
  <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full">
    <h2 class="text-xl font-bold text-center" x-text="selectedBobaType"></h2>

    <!-- Styled Topping Selection -->
    <div class="mt-4 text-sm space-y-3">
      <label class="flex items-center gap-3 p-3 border border-gray-300 rounded-lg hover:bg-gray-100 cursor-pointer">
        <input type="radio" name="topping" value="Tapioca Pearls" class="w-5 h-5 text-green-500 focus:ring-green-500">
        <span>Tapioca Pearls</span>
      </label>
      <label class="flex items-center gap-3 p-3 border border-gray-300 rounded-lg hover:bg-gray-100 cursor-pointer">
        <input type="radio" name="topping" value="Popping Boba" class="w-5 h-5 text-green-500 focus:ring-green-500">
        <span>Popping Boba</span>
      </label>
      <label class="flex items-center gap-3 p-3 border border-gray-300 rounded-lg hover:bg-gray-100 cursor-pointer">
        <input type="radio" name="topping" value="Jelly" class="w-5 h-5 text-green-500 focus:ring-green-500">
        <span>Jelly</span>
      </label>
    </div>

    <p class="text-left mt-4 text-xs text-gray-500">
      Note: Extra toppings can be added at a fee in the special requests section.
    </p>

    <div class="text-center mt-4">
      <button
        class="bg-green-500 text-white p-3 rounded w-full hover:bg-green-600 focus:ring-2 focus:outline-none focus:ring-green-300"
        @click="addToppings()"
      >
        Add Toppings
      </button>
      <button
        class="border-2 border-red-500 text-red-500 p-3 rounded w-full mt-2 hover:bg-red-200 focus:ring-2 focus:outline-none focus:ring-red-300"
        @click="showToppingsModal = false"
      >
        Cancel
      </button>
    </div>
  </div>
</div>


    <!-- Shawarma Size Modal -->
    <div
      x-show="showShawarmaModal"
      class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
    >
      <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full">
        <h2
          class="text-xl font-bold text-center"
          x-text="selectedShawarmaType"
        ></h2>
        <div class="mt-4 text-sm">
          <button
            class="bg-gray-200 text-black p-2 rounded w-full hover:bg-gray-300 focus:ring-2 focus:outline-none focus:ring-gray-300"
            @click="addShawarma(selectedShawarmaType, 'Medium', selectedShawarmaType.includes('Chicken') ? 35 : 40)"
          >
            Medium
          </button>
          <button
            class="bg-gray-300 text-black p-2 rounded w-full mt-2 hover:bg-gray-400 focus:ring-2 focus:outline-none focus:ring-gray-300"
            @click="addShawarma(selectedShawarmaType, 'Large', selectedShawarmaType.includes('Chicken') ? 45 : 50)"
          >
            Large
          </button>
        </div>
        <div class="text-center mt-4">
          <button
            class="border-2 border-red-500 text-red-500 p-2 rounded w-full mt-2 hover:bg-red-200 focus:ring-2 focus:outline-none focus:ring-red-300"
            @click="showShawarmaModal = false"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div
      x-show="showModal"
      class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
    >
      <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full">
        <h2 class="text-xl font-bold text-center">Confirm Your Order</h2>
        <p class="text-center mt-4 text-sm">
          Please review your order details below:
        </p>
        <div class="mt-4 text-sm">
          <p><strong>Name:</strong> <span x-text="name"></span></p>
          <p><strong>Location:</strong> <span x-text="location"></span></p>
          <p><strong>Phone:</strong> <span x-text="phone"></span></p>
          <p><strong>Notes:</strong> <span x-text="notes"></span></p>
          <p><strong>Order:</strong> <span id="order-summary"></span></p>
          <p><strong>Total:</strong> <span x-text="total"></span> GHS</p>
        </div>
        <div class="text-center mt-4">
          <button
            class="bg-green-500 text-white p-2 rounded w-full hover:bg-green-600 focus:ring-2 focus:outline-none focus:ring-green-300"
            @click="document.querySelector('form').submit()"
          >
            Confirm
          </button>
          <button
            class="border-2 border-red-500 text-red-500 p-2 rounded w-full mt-2 hover:bg-red-200 focus:ring-2 focus:outline-none focus:ring-red-300"
            @click="showModal = false"
          >
            Edit
          </button>
        </div>
      </div>
    </div>

    <script>
      let cart = [];

      function selectBobaType(type) {
        document.querySelector("[x-data]").__x.$data.selectedBobaType = type;
        document.querySelector("[x-data]").__x.$data.showToppingsModal = true;
      }

      function addToppings() {
        const topping = document.querySelector(
          'input[name="topping"]:checked'
        ).value;
        const selectedBobaType =
          document.querySelector("[x-data]").__x.$data.selectedBobaType;
        addToCart(selectedBobaType + " with " + topping, 30);
        document.querySelector("[x-data]").__x.$data.showToppingsModal = false;
      }

      function selectShawarmaType(type) {
        document.querySelector("[x-data]").__x.$data.selectedShawarmaType =
          type;
        document.querySelector("[x-data]").__x.$data.showShawarmaModal = true;
      }

      function addShawarma(type, size, price) {
        addToCart(type + " (" + size + ")", price);
        document.querySelector("[x-data]").__x.$data.showShawarmaModal = false;
      }

      function addToCart(item, price) {
        let existingItem = cart.find((cartItem) => cartItem.name === item);
        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({ name: item, price: price, quantity: 1 });
        }
        updateCart();
      }

      function removeFromCart(index) {
        if (cart[index].quantity > 1) {
          cart[index].quantity -= 1;
        } else {
          cart.splice(index, 1);
        }
        updateCart();
      }

      function updateCart() {
        let cartList = document.getElementById("cart");
        cartList.innerHTML = "";
        let total = 0;
        cart.forEach((item, index) => {
          let li = document.createElement("li");
          li.textContent = `${item.name} x${item.quantity} - ${
            item.price * item.quantity
          } GHS`;
          li.classList.add("cursor-pointer", "hover:text-red-500");
          li.onclick = () => removeFromCart(index);
          let removeButton = document.createElement("span");
          removeButton.textContent = " x";
          removeButton.classList.add("text-red-500", "cursor-pointer", "ml-2");
          removeButton.onclick = () => removeFromCart(index);
          li.appendChild(removeButton);
          cartList.appendChild(li);
          total += item.price * item.quantity;
        });
        document.getElementById("total").textContent = total;
        document.getElementById("total-input").value = total;
        document.getElementById("order-input").value = cart
          .map((item) => `${item.name} x${item.quantity}`)
          .join(", ");

        if (total > 0) {
          document.getElementById("total-container").classList.remove("hidden");
        } else {
          document.getElementById("total-container").classList.add("hidden");
        }

        // Update the order summary in the modal
        document.getElementById("order-summary").textContent = cart
          .map((item) => `${item.name} x${item.quantity}`)
          .join(", ");
      }

      function generateOrderNumber() {
        const chars = "abcdefghijklmnopqrstuvwxyz0123456789";
        let result = "boba-";
        for (let i = 0; i < 4; i++) {
          result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
      }

      function validateForm() {
        const form = document.getElementById("order-form");
        if (form.checkValidity() && cart.length > 0) {
          document.querySelector("[x-data]").__x.$data.showModal = true;
          document.querySelector("[x-data]").__x.$data.total =
            document.getElementById("total").textContent;
          document.querySelector("[x-data]").__x.$data.orderNumber =
            generateOrderNumber();
        } else {
          form.reportValidity();
          if (cart.length === 0) {
            alert("Please select at least one item.");
          }
        }
      }
    </script>
  </body>
</html>
