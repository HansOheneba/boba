<!DOCTYPE html>
<html
  lang="en"
  x-data="{
    showModal: false,
    showToppingsModal: false,
    showShawarmaModal: false,
    showIceTeaModal: false,
    total: 0,
    orderNumber: '',
    name: localStorage.getItem('name') || '',
    location: localStorage.getItem('location') || '',
    preferences: '',  // Use preferences instead of notes
    phone: localStorage.getItem('phone') || '',
    email: localStorage.getItem('email') || '',  // Ensure email is initialized
    selectedBoba: '',
    selectedShawarma: '',
    selectedShawarmaType: '',
    selectedBobaType: '',
    selectedIceTeaType: '',
    isLoading: true,
    selectedBobaSize: 'Large',
    selectedBobaTopping: 'No Toppings',
    disableToppings: false,
    selectedBobaQuantity: 1,
    selectedShawarmaQuantity: 1,
    selectedIceTeaQuantity: 1,
    selectedIceTeaSize: 'Medium'
  }"
  x-init="window.addEventListener('load', () => { isLoading = false; })"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="{{ url_for('static', filename='img/logo.png') }}"
      type="image/png"
    />
    <title>Boba & Shawarma | Bubble Bliss</title>
    <meta name="theme-color" content="#000000" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Playwrite+US+Trad:wght@100..400&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Quicksand:wght@300..700&family=Satisfy&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdn.tailwindcss.com"></script>

    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js"
      defer
    ></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <style>
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      .dot {
        display: inline-block;
        width: 8px;
        height: 8px;
        margin: 0 2px;
        background-color: #8700c5;
        border-radius: 50%;
        animation: bounce 0.6s infinite alternate;
      }
      .dot:nth-child(2) {
        animation-delay: 0.2s;
      }
      .dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes bounceSide {
        0%,
        100% {
          transform: translateX(0);
        } /* Start and end at the same place */
        50% {
          transform: translateX(10px);
        } /* Move forward */
      }

      .bounce-side {
        animation: bounceSide 1s infinite ease-in-out;
      }
    </style>
  </head>
  <body class="bg-[black] text-white">
    <!-- Loading Animation -->
    <div
      x-show="isLoading"
      class="fixed inset-0 flex flex-col items-center justify-center gap-20 bg-black z-50"
    >
      <h1 class="text-white text-2xl font-bold font-[satisfy] text-center">
        Bubble Bliss
      </h1>
      <div class="flex space-x-2">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
    </div>

    <div
      class="max-w-md mx-auto bg-black shadow-lg rounded-lg overflow-hidden mt-2 font-[quicksand]"
      x-show="!isLoading"
    >
      <div class="p-4">
        <img
          class="h-24 mx-auto mb-10"
          src="{{url_for('static', filename='img/logo.png')}}"
          alt="logo"
        />
        <!-- <h1
          class="text-white text-2xl font-bold font-[satisfy] text-center mb-10"
        >
          Bubble Bliss
        </h1> -->
        <form action="/" method="POST" class="mt-4" id="order-form">
          <div class="mt-4">
            <div class="flex justify-between items-center">
              <h2 class="text-lg text-white font-semibold">Milk Tea</h2>

              <div class="text-purple-500 flex items-center gap-2">
                <p>scroll</p>
                <i class="fa-solid fa-arrow-right pr-5 bounce-side"></i>
              </div>
            </div>
            <div class="overflow-x-auto whitespace-nowrap flex gap-4 mt-4 p-2">
              <div class="grid grid-flow-col grid-rows-3 gap-2">
                <!-- Blueberry Boba -->
                <div
                  class="flex items-center justify-center relative bg-[#161618] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/blueberry_boba.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Blueberry Boba' }"
                  @click="selectBobaType('Blueberry Boba')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Blueberry Boba</p>
                </div>
                <!-- Brown Sugar Boba -->
                <div
                  class="flex items-center justify-center relative bg-purple-950 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/brown_sugar_boba.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Brown Sugar Boba' }"
                  @click="selectBobaType('Brown Sugar Boba')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Brown Sugar Boba</p>
                </div>

                <!-- Caramel Milk -->
                <div
                  class="flex items-center justify-center relative bg-amber-500 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/caramel_milk.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Caramel Milk' }"
                  @click="selectBobaType('Caramel Milk')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Caramel Milk</p>
                </div>

                <!-- Classic Boba -->
                <div
                  class="flex items-center justify-center relative bg-gray-700 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/classic_boba.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Classic Boba' }"
                  @click="selectBobaType('Classic Boba')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Classic Boba</p>
                </div>

                <!-- Coconut Milk -->
                <div
                  class="flex items-center justify-center relative bg-teal-500 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/coconut_milk.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Coconut Milk' }"
                  @click="selectBobaType('Coconut Milk')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Coconut Milk</p>
                </div>

                <!-- Coffee -->
                <div
                  class="flex items-center justify-center relative bg-red-950 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/coffee.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Coffee' }"
                  @click="selectBobaType('Coffee')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Dalgona Coffee</p>
                </div>

                <!-- Taro Boba -->
                <div
                  class="flex items-center justify-center relative bg-purple-500 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/taro_boba.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Taro Boba' }"
                  @click="selectBobaType('Taro Boba')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Taro Boba</p>
                </div>

                <!-- Vanilla Boba -->
                <div
                  class="flex items-center justify-center relative bg-yellow-300 text-white p-4 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/vanilla_boba.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Vanilla Boba' }"
                  @click="selectBobaType('Vanilla Boba')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Vanilla Boba</p>
                </div>

                <!-- New Flavors -->
                <!-- Lilac (Grape) -->
                <div
                  class="flex items-center justify-center relative bg-[#522b5b] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/grape.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Lilac (Grape)' }"
                  @click="selectBobaType('Lilac (Grape)')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Lilac (Grape)</p>
                </div>

                <!-- Dew Drop-Honeydew -->
                <div
                  class="flex items-center justify-center relative bg-[#2b5731] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/dew_drop.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Dew Drop-Honeydew' }"
                  @click="selectBobaType('Dew Drop-Honeydew')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Dew Drop-Honeydew</p>
                </div>

                <!-- Strawberry-Rosey Rush -->
                <div
                  class="flex items-center justify-center relative bg-[#8b2f47] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/strawberry.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Strawberry-Rosey Rush' }"
                  @click="selectBobaType('Strawberry-Rosey Rush')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Strawberry-Rosey Rush</p>
                </div>

                <!-- Banana Breeze -->
                <div
                  class="flex items-center justify-center relative bg-[#a57c2b] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/banana.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Banana Breeze' }"
                  @click="selectBobaType('Banana Breeze')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Banana Breeze</p>
                </div>

                <!-- Lotus-Bliss -->
                <div
                  class="flex items-center justify-center relative bg-[#204f78] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/lotus.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Lotus-Bliss' }"
                  @click="selectBobaType('Lotus-Bliss')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Lotus-Bliss</p>
                </div>

                <!-- Matcha-Emerald -->
                <div
                  class="flex items-center justify-center relative bg-[#29663e] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/matcha.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Matcha-Emerald' }"
                  @click="selectBobaType('Matcha-Emerald')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Matcha-Emerald</p>
                </div>

                <!-- Chocolate Delight -->
                <div
                  class="flex items-center justify-center relative bg-[#4a2c2a] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/chocolate.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Chocolate Delight' }"
                  @click="selectBobaType('Chocolate Delight')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Chocolate Delight</p>
                </div>

                <!-- Oreoreo -->
                <div
                  class="flex items-center justify-center relative bg-[#2f2f2f] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/oreo.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Oreoreo' }"
                  @click="selectBobaType('Oreoreo')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Oreoreo</p>
                </div>

                <!-- Piñata-Pineapple -->
                <div
                  class="flex items-center justify-center relative bg-[#a57c2b] text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/pineapple.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Piñata-Pineapple' }"
                  @click="selectBobaType('Piñata-Pineapple')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Piñata-Pineapple</p>
                </div>

                <!-- Pudding (Custard) -->
                <div
                  class="flex items-center justify-center relative bg-yellow-200 text-white p-6 rounded-lg shadow-lg text-center cursor-pointer w-48 bg-[url({{ url_for('static', filename='img/custard.png') }})] bg-cover bg-top"
                  x-bind:class="{ 'border-green-500': selectedBobaType === 'Pudding (Custard)' }"
                  @click="selectBobaType('Pudding (Custard)')"
                >
                  <div
                    class="absolute inset-0 bg-black bg-opacity-10 rounded-lg"
                  ></div>
                  <p class="font-bold relative z-10">Pudding (Custard)</p>
                </div>
              </div>
            </div>
          </div>
          <div class="mt-4 text-sm">
            <h2 class="text-lg font-semibold">Ice Tea</h2>
            <div class="grid grid-cols-1 gap-4 mt-4 text-white">
              <button
                type="button"
                class="h-28 p-4 text-lg rounded-lg font-bold bg-[url({{ url_for('static', filename='img/lemonade.png') }})] bg-cover"
                onclick="selectIceTeaType('Fizzy Lemonade')"
              >
                <p class="z-10 text-white brightness-100">Fizzy Lemonade</p>
              </button>
            </div>
          </div>
          <div class="mt-4 text-sm">
            <h2 class="text-lg font-semibold">Shawarma</h2>
            <div class="grid grid-cols-2 gap-4 mt-4 text-white">
              <button
                type="button"
                class="h-28 p-4 text-lg rounded-lg font-bold bg-[url({{ url_for('static', filename='img/chicken.png') }})] bg-cover"
                onclick="selectShawarmaType('Chicken Shawarma')"
              >
                <p class="z-10 text-white brightness-100">Chicken Shawarma</p>
              </button>
              <button
                type="button"
                class="h-28 p-4 rounded-lg bg-[url({{ url_for('static', filename='img/beef.png') }})] bg-cover font-bold text-lg"
                onclick="selectShawarmaType('Beef Shawarma')"
              >
                Beef Shawarma
              </button>
            </div>
          </div>

          <div class="mt-4">
            <h2 class="text-lg font-semibold">Your Order</h2>
            <ul id="cart" class="list-disc pl-4 text-xs text-gray-300"></ul>
            <div
              id="total-container"
              class="mt-2 text-right font-bold hidden text-white"
            >
              Total: <span id="total">0</span> GHS
            </div>
            <input type="hidden" name="order" id="order-input" />
            <input type="hidden" name="total" id="total-input" />

            <input
              type="text"
              name="name"
              placeholder="Enter your name"
              required
              class="w-full p-3 mt-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
              x-model="name"
            />

            <input
              type="text"
              name="location"
              placeholder="Enter your location"
              required
              class="w-full p-3 mt-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
              x-model="location"
            />

            <textarea
              name="notes"
              placeholder="Any special requests?"
              class="w-full p-3 mt-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
              x-model="preferences"  // Use preferences instead of notes
            ></textarea>

            <input
              type="text"
              name="phone"
              placeholder="Enter your phone number"
              required
              class="w-full p-3 mt-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
              x-model="phone"
            />

            <input
              type="email"
              name="email"
              placeholder="Enter your email"
              required
              class="w-full p-3 mt-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
              x-model="email"
            />

            <button
              type="button"
              class="mt-5 w-full bg-purple-800 text-white p-3 rounded-lg shadow-md hover:bg-purple-950 focus:ring-2 focus:ring-purple-500 transition"
              @click="validateForm()"
            >
              Place Order
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Toppings Modal -->
    <div
      x-show="showToppingsModal"
      class="fixed z-20 inset-0 flex items-center justify-center bg-black bg-opacity-70 p-4"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 scale-90"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100 scale-100"
      x-transition:leave-end="opacity-0 scale-90"
    >
      <div
        class="bg-[#12091A] border border-gray-700 p-6 rounded-xl shadow-lg max-w-sm w-full"
      >
        <h2
          class="text-xl font-bold text-gray-300 text-center"
          x-text="selectedBobaType"
        ></h2>
        <!-- Size Selection -->
        <div class="mt-4 text-sm space-y-3">
          <label class="block text-gray-300">Size</label>
          <select
            x-model="selectedBobaSize"
            class="w-full p-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
            @change="selectedBobaSize === 'Medium' ? disableToppings = true : disableToppings = false"
          >
            <option value="Large">Large</option>
            <option value="Medium">Medium (No Toppings)</option>
          </select>
        </div>
        <!-- Toppings Selection -->
        <div class="mt-4 text-sm space-y-3">
          <label class="block text-gray-300">Toppings</label>
          <select
            x-model="selectedBobaTopping"
            class="w-full p-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
            :disabled="selectedBobaSize === 'Medium'"
          >
            <option value="No Toppings">No Toppings</option>
            <option value="Chocolate">Chocolate</option>
            <option value="Sweetened Choco">Sweetened Choco</option>
            <option value="Vanilla">Vanilla</option>
            <option value="Cheese Foam">Cheese Foam</option>
            <option value="Strawberry Popping">Strawberry Popping</option>
            <option value="Whipped Cream">Whipped Cream</option>
            <option value="Biscoff Spread">Biscoff Spread</option>
            <option value="Biscoff Topping">Biscoff Topping</option>
            <option value="Caramel Syrup">Caramel Syrup</option>
          </select>
        </div>
        <!-- Multiplier Selection -->
        <div class="mt-4 text-sm space-y-3">
          <label class="block text-gray-300">Quantity</label>
          <div class="flex items-center space-x-3">
            <button
              type="button"
              class="bg-gray-600 text-white px-3 py-1 rounded-lg"
              @click="selectedBobaQuantity = Math.max(1, selectedBobaQuantity - 1)"
            >
              -
            </button>
            <span x-text="selectedBobaQuantity" class="text-gray-300"></span>
            <button
              type="button"
              class="bg-gray-600 text-white px-3 py-1 rounded-lg"
              @click="selectedBobaQuantity++"
            >
              +
            </button>
          </div>
        </div>
        <p class="text-left mt-4 text-xs text-gray-500">
          Note: Extra toppings can be added at a fee in the special requests
          section.
        </p>
        <div class="text-center mt-4">
          <button
            class="bg-purple-950 text-white p-3 rounded-lg w-full hover:bg-[#2B163B] focus:ring-2 focus:outline-none focus:ring-purple-600 transition"
            @click="addToppings()"
          >
            Add
          </button>
          <button
            class="border-2 border-gray-600 text-gray-300 p-3 rounded-lg w-full hover:bg-gray-800 mt-2 hover:text-white focus:ring-2 focus:outline-none focus:ring-gray-500 transition"
            @click="showToppingsModal = false"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Shawarma Size Modal -->
    <div
      x-show="showShawarmaModal"
      class="fixed z-20 inset-0 flex items-center justify-center bg-black bg-opacity-70 p-4"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 scale-90"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100 scale-100"
      x-transition:leave-end="opacity-0 scale-90"
    >
      <div
        class="bg-[#12091A] border border-gray-700 p-6 rounded-xl shadow-lg max-w-sm w-full"
      >
        <h2
          class="text-xl font-bold text-gray-300 text-center"
          x-text="selectedShawarmaType"
        ></h2>

        <div class="mt-4 text-sm space-y-3">
          <label
            class="flex items-center gap-3 p-3 border border-gray-600 rounded-lg hover:bg-[#1C0F2D] cursor-pointer transition"
          >
            <input
              type="radio"
              name="shawarma_size"
              value="Medium"
              class="w-5 h-5 text-purple-500 focus:ring-purple-500"
            />
            <span class="text-gray-300">Medium</span>
          </label>

          <label
            class="flex items-center gap-3 p-3 border border-gray-600 rounded-lg hover:bg-[#1C0F2D] cursor-pointer transition"
          >
            <input
              type="radio"
              name="shawarma_size"
              value="Large"
              class="w-5 h-5 text-purple-500 focus:ring-purple-500"
            />
            <span class="text-gray-300">Large</span>
          </label>
        </div>
        <!-- Multiplier Selection -->
        <div class="mt-4 text-sm space-y-3">
          <label class="block text-gray-300">Quantity</label>
          <div class="flex items-center space-x-3">
            <button
              type="button"
              class="bg-gray-600 text-white px-3 py-1 rounded-lg"
              @click="selectedShawarmaQuantity = Math.max(1, selectedShawarmaQuantity - 1)"
            >
              -
            </button>
            <span
              x-text="selectedShawarmaQuantity"
              class="text-gray-300"
            ></span>
            <button
              type="button"
              class="bg-gray-600 text-white px-3 py-1 rounded-lg"
              @click="selectedShawarmaQuantity++"
            >
              +
            </button>
          </div>
        </div>
        <div class="text-center mt-4">
          <button
            class="bg-purple-950 text-white p-3 rounded-lg w-full hover:bg-[#2B1A40] focus:ring-2 focus:outline-none focus:ring-purple-600 transition"
            @click="addShawarma()"
          >
            Add
          </button>
          <button
            class="border-2 border-gray-500 text-white p-3 rounded-lg w-full mt-2 hover:bg-gray-800 hover:text-white focus:ring-2 focus:outline-none focus:ring-gray-600 transition"
            @click="showShawarmaModal = false"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Ice Tea Modal -->
    <div
      x-show="showIceTeaModal"
      class="fixed z-20 inset-0 flex items-center justify-center bg-black bg-opacity-70 p-4"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 scale-90"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100 scale-100"
      x-transition:leave-end="opacity-0 scale-90"
    >
      <div
        class="bg-[#12091A] border border-gray-700 p-6 rounded-xl shadow-lg max-w-sm w-full"
      >
        <h2
          class="text-xl font-bold text-gray-300 text-center"
          x-text="selectedIceTeaType"
        ></h2>
        <!-- Size Selection -->
        <div class="mt-4 text-sm space-y-3">
          <label class="block text-gray-300">Size</label>
          <select
            x-model="selectedIceTeaSize"
            class="w-full p-3 bg-[#1C1C1E] text-gray-300 border border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-[#007AFF] focus:outline-none transition"
          >
            <option value="Medium">Medium</option>
            <option value="Large">Large</option>
          </select>
        </div>
        <!-- Multiplier Selection -->
        <div class="mt-4 text-sm space-y-3">
          <label class="block text-gray-300">Quantity</label>
          <div class="flex items-center space-x-3">
            <button
              type="button"
              class="bg-gray-600 text-white px-3 py-1 rounded-lg"
              @click="selectedIceTeaQuantity = Math.max(1, selectedIceTeaQuantity - 1)"
            >
              -
            </button>
            <span x-text="selectedIceTeaQuantity" class="text-gray-300"></span>
            <button
              type="button"
              class="bg-gray-600 text-white px-3 py-1 rounded-lg"
              @click="selectedIceTeaQuantity++"
            >
              +
            </button>
          </div>
        </div>
        <div class="text-center mt-4">
          <button
            class="bg-purple-950 text-white p-3 rounded-lg w-full hover:bg-[#2B1A40] focus:ring-2 focus:outline-none focus:ring-purple-600 transition"
            @click="addIceTea()"
          >
            Add
          </button>
          <button
            class="border-2 border-gray-500 text-white p-3 rounded-lg w-full mt-2 hover:bg-gray-800 hover:text-white focus:ring-2 focus:outline-none focus:ring-gray-600 transition"
            @click="showIceTeaModal = false"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div
      x-show="showModal"
      class="fixed z-50 inset-0 flex items-center justify-center bg-black bg-opacity-70 p-4"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 scale-90"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="opacity-100 scale-100"
      x-transition:leave-end="opacity-0 scale-90"
    >
      <div
        class="bg-[#12091A] border border-gray-700 p-6 rounded-xl shadow-lg max-w-sm w-full"
      >
        <h2 class="text-xl font-bold text-gray-300 text-center">
          Confirm Your Order
        </h2>
        <p class="text-center mt-4 text-gray-400 text-sm">
          Please review your order details below:
        </p>

        <div class="mt-4 text-sm space-y-2">
          <p class="flex justify-between text-gray-400">
            <strong class="text-gray-300">Name:</strong>
            <span
              class="bg-gray-800/20 px-2 py-1 rounded text-gray-300"
              x-text="name"
            ></span>
          </p>
          <p class="flex justify-between text-gray-400">
            <strong class="text-gray-300">Location:</strong>
            <span
              class="bg-gray-800/20 px-2 py-1 rounded text-gray-300"
              x-text="location"
            ></span>
          </p>
          <p class="flex justify-between text-gray-400">
            <strong class="text-gray-300">Phone:</strong>
            <span
              class="bg-gray-800/20 px-2 py-1 rounded text-gray-300"
              x-text="phone"
            ></span>
          </p>
          <p class="flex justify-between text-gray-400">
            <strong class="text-gray-300">Notes:</strong>
            <span
              class="bg-gray-800/20 px-2 py-1 rounded text-gray-300"
              x-text="preferences"
            ></span>
          </p>
          <p class="flex justify-between text-gray-400">
            <strong class="text-gray-300">Email:</strong>
            <span
              class="bg-gray-800/20 px-2 py-1 rounded text-gray-300"
              x-text="email"
            ></span>
          </p>
          <p class="flex justify-between text-gray-400 text-right">
            <strong class="text-gray-300">Order:</strong>
            <span
              id="order-summary"
              class="bg-gray-800/20 px-2 py-1 rounded text-gray-300"
            ></span>
          </p>
          <div class="flex justify-between text-gray-400">
            <strong class="text-gray-300">Total:</strong>
            <div class="flex items-center gap-2">
              <span
                class="bg-gray-800/20 px-2 py-1 rounded text-purple-400 font-semibold"
                x-text="total"
              ></span>
              GHS
            </div>
          </div>
        </div>

        <div class="text-center mt-6">
          <button
            class="bg-purple-900 text-white p-3 rounded-lg w-full hover:bg-[#2B1A40] focus:ring-2 focus:outline-none focus:ring-purple-600 transition"
            @click="payWithPaystack()"
          >
            Confirm
          </button>
          <button
            class="border-2 border-gray-500 text-white p-3 rounded-lg w-full mt-2 hover:bg-purple-800 hover:text-white focus:ring-2 focus:outline-none focus:ring-gray-600 transition"
            @click="showModal = false"
          >
            Edit
          </button>
        </div>
      </div>
    </div>

    <script>
      let cart = [];

      function selectBobaType(type) {
        document.querySelector("[x-data]").__x.$data.selectedBobaType = type;
        document.querySelector("[x-data]").__x.$data.selectedBobaSize = "Large";
        document.querySelector("[x-data]").__x.$data.selectedBobaTopping =
          "No Toppings";
        document.querySelector("[x-data]").__x.$data.selectedBobaQuantity = 1;
        document.querySelector("[x-data]").__x.$data.disableToppings = false;
        document.querySelector("[x-data]").__x.$data.showToppingsModal = true;
      }

      function addToppings() {
        const size =
          document.querySelector("[x-data]").__x.$data.selectedBobaSize;
        const topping =
          document.querySelector("[x-data]").__x.$data.selectedBobaTopping;
        const quantity =
          document.querySelector("[x-data]").__x.$data.selectedBobaQuantity;
        const selectedBobaType =
          document.querySelector("[x-data]").__x.$data.selectedBobaType;
        let price = size === "Large" ? 40 : 30; // Default price for large with toppings

        if (size === "Medium") {
          price = 30; // Price for medium with no toppings
          addToCart(selectedBobaType + " (" + size + ")", price, quantity);
        } else {
          addToCart(
            selectedBobaType + " (" + size + ") with " + topping,
            price,
            quantity
          );
        }

        document.querySelector("[x-data]").__x.$data.showToppingsModal = false;
      }

      function selectShawarmaType(type) {
        document.querySelector("[x-data]").__x.$data.selectedShawarmaType =
          type;
        document.querySelector(
          "[x-data]"
        ).__x.$data.selectedShawarmaQuantity = 1;
        document.querySelector("[x-data]").__x.$data.showShawarmaModal = true;
      }

      function addShawarma() {
        const size = document.querySelector(
          'input[name="shawarma_size"]:checked'
        ).value;
        const quantity =
          document.querySelector("[x-data]").__x.$data.selectedShawarmaQuantity;
        const selectedShawarmaType =
          document.querySelector("[x-data]").__x.$data.selectedShawarmaType;
        let price =
          size === "Medium"
            ? selectedShawarmaType.includes("Chicken")
              ? 35
              : 40
            : selectedShawarmaType.includes("Chicken")
            ? 45
            : 50;

        addToCart(selectedShawarmaType + " (" + size + ")", price, quantity);
        document.querySelector("[x-data]").__x.$data.showShawarmaModal = false;
      }

      function selectIceTeaType(type) {
        document.querySelector("[x-data]").__x.$data.selectedIceTeaType = type;
        document.querySelector("[x-data]").__x.$data.selectedIceTeaSize =
          "Medium";
        document.querySelector("[x-data]").__x.$data.selectedIceTeaQuantity = 1;
        document.querySelector("[x-data]").__x.$data.showIceTeaModal = true;
      }

      function addIceTea() {
        const size =
          document.querySelector("[x-data]").__x.$data.selectedIceTeaSize;
        const quantity =
          document.querySelector("[x-data]").__x.$data.selectedIceTeaQuantity;
        const selectedIceTeaType =
          document.querySelector("[x-data]").__x.$data.selectedIceTeaType;
        let price = size === "Large" ? 40 : 30; // Default price for large

        addToCart(selectedIceTeaType + " (" + size + ")", price, quantity);
        document.querySelector("[x-data]").__x.$data.showIceTeaModal = false;
      }

      function addToCart(item, price, quantity = 1) {
        let existingItem = cart.find((cartItem) => cartItem.name === item);
        if (existingItem) {
          existingItem.quantity += quantity;
        } else {
          cart.push({ name: item, price: price, quantity: quantity });
        }
        updateCart();
      }

      function removeFromCart(index) {
        if (cart[index].quantity > 1) {
          cart[index].quantity -= 1;
        } else {
          cart.splice(index, 1);
        }
        updateCart();
      }

      function updateCart() {
        let cartList = document.getElementById("cart");
        cartList.innerHTML = "";
        let total = 0;
        cart.forEach((item, index) => {
          let li = document.createElement("li");
          li.innerHTML = `${
            item.name
          } <span style="font-weight: bold; color: #ff9fe5;">x${
            item.quantity
          }</span> - <span style="font-weight: bold; color: #ff9fe5;">${
            item.price * item.quantity
          } GHS</span>`;
          li.classList.add("cursor-pointer", "hover:text-red-500");
          li.onclick = () => removeFromCart(index);
          let removeButton = document.createElement("span");
          removeButton.textContent = " x";
          removeButton.classList.add("text-red-500", "cursor-pointer", "ml-2");
          removeButton.onclick = () => removeFromCart(index);
          li.appendChild(removeButton);
          cartList.appendChild(li);
          total += item.price * item.quantity;
        });
        document.getElementById("total").textContent = total;
        document.getElementById("total-input").value = total;
        document.getElementById("order-input").value = cart
          .map((item) => `${item.name} x${item.quantity}`)
          .join(", ");

        if (total > 0) {
          document.getElementById("total-container").classList.remove("hidden");
        } else {
          document.getElementById("total-container").classList.add("hidden");
        }

        // Update the order summary in the modal
        document.getElementById("order-summary").textContent = cart
          .map((item) => `${item.name} x${item.quantity}`)
          .join(", ");
      }

      function generateOrderNumber() {
        const chars = "abcdefghijklmnopqrstuvwxyz0123456789";
        let result = "boba-";
        for (let i = 0; i < 4; i++) {
          result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
      }

      function validateForm() {
        const form = document.getElementById("order-form");
        if (form.checkValidity() && cart.length > 0) {
          document.querySelector("[x-data]").__x.$data.showModal = true;
          document.querySelector("[x-data]").__x.$data.total =
            document.getElementById("total").textContent;
          document.querySelector("[x-data]").__x.$data.orderNumber =
            generateOrderNumber();
        } else {
          form.reportValidity();
          if (cart.length === 0) {
            alert("Please select at least one item.");
          }
        }
      }

      function payWithPaystack() {
        const handler = PaystackPop.setup({
          key: 'pk_test_de389fd1dddaa1ccf384e65b4d1a410d04a2dd42', 
          email: document.querySelector("[x-data]").__x.$data.email,
          amount: document.querySelector("[x-data]").__x.$data.total * 100,
          currency: 'GHS',
          ref: document.querySelector("[x-data]").__x.$data.orderNumber,
          callback: function(response) {
            // Payment successful, submit the form
            document.querySelector('form').submit();
          },
          onClose: function() {
            alert('Payment cancelled');
          }
        });
        handler.openIframe();
      }

      document.addEventListener("DOMContentLoaded", function () {
        // Retrieve stored values from local storage
        const storedName = localStorage.getItem("name");
        const storedLocation = localStorage.getItem("location");
        const storedPhone = localStorage.getItem("phone");
        const storedEmail = localStorage.getItem("email");

        if (storedName)
          document.querySelector("[name='name']").value = storedName;
        if (storedLocation)
          document.querySelector("[name='location']").value = storedLocation;
        if (storedPhone)
          document.querySelector("[name='phone']").value = storedPhone;
        if (storedEmail)
          document.querySelector("[name='email']").value = storedEmail;

        // Store values in local storage on input change
        document
          .querySelector("[name='name']")
          .addEventListener("input", function () {
            localStorage.setItem("name", this.value);
          });
        document
          .querySelector("[name='location']")
          .addEventListener("input", function () {
            localStorage.setItem("location", this.value);
          });
        document
          .querySelector("[name='phone']")
          .addEventListener("input", function () {
            localStorage.setItem("phone", this.value);
          });
        document
          .querySelector("[name='email']")
          .addEventListener("input", function () {
            localStorage.setItem("email", this.value);
          });
      });
    </script>
  </body>
</html>
